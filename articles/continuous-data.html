<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Applicability domain methods for continuous data • applicable</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Applicability domain methods for continuous data">
<meta property="og:description" content="applicable">
<meta property="og:image" content="https://applicable.tidymodels.org/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">applicable</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/binary-data.html">Applicability domain methods for binary data</a>
    </li>
    <li>
      <a href="../articles/continuous-data.html">Applicability domain methods for continuous data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tidymodels/applicable/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Applicability domain methods for continuous
data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/applicable/blob/HEAD/vignettes/continuous-data.Rmd" class="external-link"><code>vignettes/continuous-data.Rmd</code></a></small>
      <div class="hidden name"><code>continuous-data.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/applicable" class="external-link">applicable</a></span><span class="op">)</span></span></code></pre></div>
<p><code>applicable</code> provides the following methods to analyze the
applicability domain of your model:</p>
<ul>
<li>Principal component analysis</li>
<li>Hat values statistics</li>
</ul>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>We will use the Ames IA housing data for our example.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modeldata.tidymodels.org" class="external-link">modeldata</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ames</span><span class="op">)</span></span></code></pre></div>
<p>There are 2,930 properties in the data.</p>
<p>The Sale Price was recorded along with 74 predictors, including:</p>
<ul>
<li>Location (e.g. neighborhood) and lot information.</li>
<li>House components (garage, fireplace, pool, porch, etc.).</li>
<li>General assessments such as overall quality and condition.</li>
<li>Number of bedrooms, baths, and so on.</li>
</ul>
<p>More details can be found in <a href="http://jse.amstat.org/v19n3/decock.pdf" class="external-link">De Cock (2011, Journal of
Statistics Education)</a>.</p>
<p>The raw data are at <a href="http://jse.amstat.org/v19n3/decock/AmesHousing.txt" class="external-link"><code>http://jse.amstat.org/v19n3/decock/AmesHousing.txt</code></a>
but we will use a processed version found in the <a href="https://github.com/topepo/AmesHousing" class="external-link"><code>AmesHousing</code></a>
package. <code>applicable</code> also contains an update for these data
for three new properties (although fewer fields were collected on
these).</p>
<p>To pre-process the training set, we will use the <em>recipes</em>
package. We first tell the recipes that there is an additional value for
the neighborhood in these data, then direct it to create dummy variables
for all categorical predictors. In cases where there are no levels
observed for a factor, we eliminate predictors with a single unique
value, then estimate a transformation that will make the predictor
distributions more symmetric. After these, the data are centered and
scaled. These same transformations will be applied to the new data
points using the statistics estimated from the training set.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes" class="external-link">recipes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load custom houses from applicable.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ames_new</span>, package <span class="op">=</span> <span class="st">"applicable"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ames_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'MS_SubClass'</span>, <span class="st">'Lot_Frontage'</span>, <span class="st">'Lot_Area'</span>, <span class="st">'Lot_Shape'</span>, </span>
<span>               <span class="st">'Neighborhood'</span>, <span class="st">'Bldg_Type'</span>, <span class="st">'Year_Built'</span>, <span class="st">'Central_Air'</span>, </span>
<span>               <span class="st">'Gr_Liv_Area'</span>, <span class="st">'Full_Bath'</span>, <span class="st">'Half_Bath'</span>, <span class="st">'Longitude'</span>, <span class="st">'Latitude'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">training_data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">ames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># For consistency, only analyze the data on new properties</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/one_of.html" class="external-link">one_of</a></span><span class="op">(</span><span class="va">ames_cols</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># There is a new neighborhood in ames_new</span></span>
<span>    Neighborhood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Neighborhood</span><span class="op">)</span>,</span>
<span>    Neighborhood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Neighborhood</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">ames_new</span><span class="op">$</span><span class="va">Neighborhood</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">training_recipe</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">training_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_dummy.html" class="external-link">step_dummy</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_nominal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Remove variables that have the same value for every data point.</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_zv.html" class="external-link">step_zv</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Transform variables to be distributed as Gaussian-like as possible.</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_YeoJohnson.html" class="external-link">step_YeoJohnson</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_numeric</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Normalize numeric data to have a mean of zero and</span></span>
<span>  <span class="co"># standard deviation of one.</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_normalize.html" class="external-link">step_normalize</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_numeric</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="principal-component-analysis">Principal Component Analysis<a class="anchor" aria-label="anchor" href="#principal-component-analysis"></a>
</h3>
<p>The following functions in <code>applicable</code> are used for
principal component analysis:</p>
<ul>
<li>
<code>apd_pca</code>: computes the principal components that account
for up to either 95% or the provided <code>threshold</code> of
variability. It also computes the percentiles of the principal
components and the mean of each principal component.</li>
<li>
<code>autoplot</code>: plots the distribution function for pcas. You
can also provide an optional set of <code>dplyr</code> selectors, such
as <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">dplyr::matches()</a></code> or <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">dplyr::starts_with()</a></code>,
for selecting which variables should be shown in the plot.</li>
<li>
<code>score</code>: calculates the principal components of the new
data and their percentiles as compared to the training data. The number
of principal components computed depends on the <code>threshold</code>
given at fit time. It also computes the multivariate distance between
each principal component and its mean.</li>
</ul>
<p>Let us apply <code>apd_pca</code> modeling function to our data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ames_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apd_pca.html">apd_pca</a></span><span class="op">(</span><span class="va">training_recipe</span>, <span class="va">training_data</span><span class="op">)</span></span>
<span><span class="va">ames_pca</span></span>
<span><span class="co">#&gt; # Predictors:</span></span>
<span><span class="co">#&gt;    13</span></span>
<span><span class="co">#&gt; # Principal Components:</span></span>
<span><span class="co">#&gt;    44 components were needed</span></span>
<span><span class="co">#&gt;    to capture at least 95% of the</span></span>
<span><span class="co">#&gt;    total variation in the predictors.</span></span></code></pre></div>
<p>Since no <code>threshold</code> was provided, the function computed
the number of principal components that accounted for at most 95% of the
total variance.</p>
<p>For illustration, setting <code>threshold = 0.25</code> or 25%, we
now need only 10 principal components:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ames_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apd_pca.html">apd_pca</a></span><span class="op">(</span><span class="va">training_recipe</span>, <span class="va">training_data</span>, threshold <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">ames_pca</span></span>
<span><span class="co">#&gt; # Predictors:</span></span>
<span><span class="co">#&gt;    13</span></span>
<span><span class="co">#&gt; # Principal Components:</span></span>
<span><span class="co">#&gt;    6 components were needed</span></span>
<span><span class="co">#&gt;    to capture at least 25% of the</span></span>
<span><span class="co">#&gt;    total variation in the predictors.</span></span></code></pre></div>
<p>Plotting the distribution function for the PCA scores is also
helpful:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">ames_pca</span><span class="op">)</span></span></code></pre></div>
<p><img src="continuous-data_files/figure-html/autoplot-1.png" width="576" style="display: block; margin: auto;"></p>
<p>You can use regular expressions to plot a smaller subset of the pca
statistics:</p>
<p><img src="continuous-data_files/figure-html/unnamed-chunk-5-1.png" width="768"><img src="continuous-data_files/figure-html/unnamed-chunk-5-2.png" width="768"></p>
<p>The <code>score</code> function compares the training data to new
samples. Let’s go back to the case where we capture 95% of the variation
in the predictors and score the new samples. Since we used the recipe
interface, we can give the score function the original data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ames_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apd_pca.html">apd_pca</a></span><span class="op">(</span><span class="va">training_recipe</span>, <span class="va">training_data</span><span class="op">)</span></span>
<span><span class="va">pca_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">ames_pca</span>, <span class="va">ames_new</span><span class="op">)</span></span>
<span><span class="va">pca_score</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches</a></span><span class="op">(</span><span class="st">"PC00[1-3]"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"distance"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   distance distance_pctl</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     2.48          5.32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     5.71         44.7</span></span></code></pre></div>
<p>Notice how the samples, displayed in red, are fairly dissimilar to
the training set in the first component:</p>
<p><img src="continuous-data_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p>What is driving the first component? We can look at which predictors
have the largest values in the rotation matrix (i.e. the values that
define the linear combinations in the PC scores). The top five are:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># `ames_pca$pcs` is the output of `prcomp()`</span></span>
<span><span class="va">comp_one</span> <span class="op">&lt;-</span> <span class="va">ames_pca</span><span class="op">$</span><span class="va">pcs</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">comp_one</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">comp_one</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                           Year_Built                            Full_Bath </span></span>
<span><span class="co">#&gt;                            0.3952457                            0.3136387 </span></span>
<span><span class="co">#&gt; MS_SubClass_Two_Story_1946_and_Newer                          Gr_Liv_Area </span></span>
<span><span class="co">#&gt;                            0.3123708                            0.3040630 </span></span>
<span><span class="co">#&gt;                            Half_Bath </span></span>
<span><span class="co">#&gt;                            0.2397437</span></span></code></pre></div>
<p>These three houses are extreme in the most influential variable (year
built) since they were new homes. The also tend to have fairly large
gross living areas:</p>
<p><img src="continuous-data_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>This may be what is driving the first component.</p>
<p>However, the overall distance values are relatively small, which
indicates that, overall, these new houses are not outside the mainstream
of the data.</p>
</div>
<div class="section level3">
<h3 id="hat-values">Hat Values<a class="anchor" aria-label="anchor" href="#hat-values"></a>
</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Leverage_(statistics)" class="external-link">Hat
or leverage values</a> are based on the numerics of linear regression.
The measure the distance of a data point to the center of the training
set distribution. For example, if the numeric training set matrix was
<span class="math inline">\(X_{n \times p}\)</span>, the <em>hat
matrix</em> for the training set would be computed using</p>
<p><span class="math display">\[H = X'(X'X)^{-1}X\]</span></p>
<p>The corresponding hat values for the training would be the diagonals
of <span class="math inline">\(H\)</span>. These values can be computed
using <code>stats::hatvalues(lm_model)</code> but only for an
<code>lm</code> model object. Also, it cannot compute the values for new
samples.</p>
<p>Suppose that we had a new, unknown sample (as a <span class="math inline">\(p \times 1\)</span> data vector <span class="math inline">\(u\)</span>). The hat value for this sample would
be</p>
<p><span class="math display">\[h = u^\intercal(X^\intercal
X)^{-1}u\]</span>.</p>
<p>The following functions in <code>applicable</code> are used to
compute the hat values of your model:</p>
<ul>
<li>
<code>apd_hat_values</code>: computes the matrix <span class="math inline">\((X^\intercal X)^{-1}\)</span>.</li>
<li>
<code>score</code>: calculates the hat values of new samples and
their percentiles.</li>
</ul>
<p>Two caveats for using the hat values:</p>
<ol style="list-style-type: decimal">
<li><p>The numerical methods are less tolerant than PCA. For example,
extremely correlated predictors will degrade the ability of the hat
values to be effectively used. Also, since an inverse is used, there
cannot be an linear dependencies within <span class="math inline">\(X\)</span>. To resolve this the former example,
the recipe step <code><a href="https://recipes.tidymodels.org/reference/step_corr.html" class="external-link">recipes::step_corr()</a></code> can be used to reduce
correlation. For the latter issue, <code>recipes::step_lincomp()</code>
will identify and remove linear dependencies in the data (as shown
below).</p></li>
<li><p>When using a linear or logistic model, the model adds an
intercept columns of ones to <span class="math inline">\(X\)</span>. For
equivalent computations, you should add a vector or ones to the data or
use <code><a href="https://recipes.tidymodels.org/reference/step_intercept.html" class="external-link">recipes::step_intercept()</a></code>.</p></li>
</ol>
<p>Let us apply <code>apd_hat_values</code> modeling function to our
data (while ensuring that there are no linear dependencies):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">non_singular_recipe</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">training_recipe</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_lincomb.html" class="external-link">step_lincomb</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Recipe interface</span></span>
<span><span class="va">ames_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apd_hat_values.html">apd_hat_values</a></span><span class="op">(</span><span class="va">non_singular_recipe</span>, <span class="va">training_data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">prev_options</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Marly Gotti, Max Kuhn.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
